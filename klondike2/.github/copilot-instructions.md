# copilot-instructions
# Instructions for GitHub Copilot
# Format: Markdown
# Use headings, lists, and code blocks to organize the information

## Game: Cat Te
- **Khmer Primary Goal**: Win the last trick.
- Cat Te is vietnamese for six cards and often referred to as "Six Cards". Cat Te is a trick taking card game popular in Southeast Asia. Unlike other trick games, in which the objective is either to collect tricks, avoid tricks, or fulfill a contract; the object of Cat Te is to win the last trick in a given round. The game is similar to Tien Gow, but played with cards instead of dominoes.

### Players
- 2 to 6 players

### Regions
- Khmer
- Laos
- Vietnamese

### Setup
- Player picks which region to set the game rules
- Each player is dealt 6 cards from a standard 52-card deck
- Players sit around a poker-style table in fixed positions
- The rest of the deck is not used during gameplay
- There are never more than six tricks played per game

### Objective
- Can be different depending on which region the player chooses to play in
- **Khmer Primary Goal**: Win the last trick, other tricks don't matter
- **Laos Primary Goal**: Win one or more of the first four tricks to advance to the last two tricks. After the fourth trick, players who have won no tricks are eliminated, so it is not possible to win the sixth trick without winning one of the first four tricks. 
- **Vietnamese Primary Goal**: Same as Laos


### Card Rules & Hierarchy
- Standard playing card hierarchy rank: Ace (high), King, Queen, Jack, 10, 9, 8, 7, 6, 5, 4, 3, 2
- A card can only beat another card if it's of the same suit and higher rank
- Suits have no inherent ranking (hearts = diamonds = clubs = spades)

### Suit-Following Rules
- **Must follow suit**: If you have cards of the lead suit, you MUST play one (unless you choose to fold)
- **Exception 1**: If you have no cards of the lead suit, you can play any card only if you are the lead of the trick or you can fold
- **Exception 2**: In the final (6th) trick, any card can be played regardless of suit
- **Leading**: The first player of each trick can play any card of any suit
- **Strategic Folding**: Players may choose to fold any card face-down as a strategic decision, even if they have valid cards to play

### Gameplay Phases

#### All Six Tricks (Complete Game)
1. **Leading**: The player to the dealer's left leads the first trick, then winner of each trick leads the next
2. **Following**: Other players follow in clockwise order
3. **Turn Options**: On each turn, players may:
   - **Play a valid card**: Follow suit with any card of the led suit (if available)
   - **Play any card**: If they don't have the led suit (except final trick where any suit is allowed)
   - **Fold any card**: Play any card face-down as a strategic choice, regardless of what cards they hold
4. **Folding Rules**: 
   - Players can fold any card at any time as a strategic decision
   - Folded cards are played face-down and cannot win the trick
   - Common reasons to fold: don't have the led suit, want to save a good card, or tactical play
5. **Trick Resolution**: Highest card of the led suit wins the trick (folded cards cannot win)
6. **Game Progression**: Continue for all 6 tricks until all cards are played

#### Special Final Trick Rules
1. **Sixth Trick**: No suit-following required - any card can be played face-up
2. **Winner**: Player who wins the 6th trick wins the entire game

### Instant Winning Hands (Game Ends Immediately)
- **Four-of-a-Kind**: Any four cards of the same rank
- **Flush**: All six cards of the same suit  
- **Low Hand**: All six cards valued 5 or lower (A, 2, 3, 4, 5)

### Visual Elements
- **Played Cards**: Remain visible on the table throughout the entire game
- **Card Layout**: Played cards are arranged horizontally like the original hand
- **Winner Highlighting**: Trick winners get golden borders temporarily
- **Suit Indicators**: Required suit is displayed during play
- **Valid Card Highlighting**: Invalid cards are blocked, valid cards highlighted in blue

### Game Flow
1. **Deal**: 6 cards to each player
2. **Check**: Instant win conditions (optional special hands)
3. **Play**: 6 tricks total, each player plays one card per trick
4. **Trick Sequence**: Winner of each trick leads the next trick
5. **Strategic Folding**: Players can fold any card face-down at any time
6. **Victory**: Winner of the 6th (final) trick wins the entire game

### Key Strategic Elements
- **Suit Management**: Deciding when to follow suit vs. when to fold strategically
- **Card Preservation**: Saving high cards for crucial moments
- **Bluffing**: Folding good cards to mislead opponents
- **Timing**: Knowing when to play strong cards vs. when to fold
- **Final Trick Focus**: Building towards winning the decisive 6th trick

### Play overview
Cat Te is played in rounds, each of which includes an initial bet, the deal, the play of tricks, and the settlement of any obligations incurred during play. At the conclusion of each round, all players contribute an agreed-upon sum to form the pot.

For all but the first round of play, the winner of the prior round has the privilege of dealing. For the initial round; deal can be chosen by lot, or any other means agreed upon by the players. The dealer deals six cards to each player, in counter-clockwise order. The remaining cards are then removed from play.

### Trick-play
A round of Cat Te consists of either 4 or 6 tricks. The dealer has the lead on the initial trick; the winner of each trick leads the subsequent trick. Play is standard no-trump trick-taking. Players are not required to follow suit; nor are they required to attempt to win a trick if they are able. There are no penalty cards in the game. At any time, a player may slough (play a card face-down); when this is done the player is ineligible to win the trick. After four tricks have been played, one of two situations will have occurred:

One player will have won all 4 tricks: If this occurs, that player is the winner of the round. He/she collects the pot, and becomes the dealer for the next round. If 4 or more players play (depending on house or regional rules), the player is additionally entitled to double his winnings—the other players must immediately pay the winner an additional amount equal to the initial bet.
Two or more players will have won at least one trick: (There is no advantage to winning more than one trick in the first four rounds). All players who have failed to win any tricks are eliminated from further play at this point; those players who have won at least one trick may continue.
At this point, the 5th trick is played. The winner of the 4th trick leads one of his two remaining cards. The other remaining players play a card face down; after all cards are played, they are overturned. The winner of the 5th trick leads the last trick; all remaining cards are then shown. The winner of the 6th trick wins the round, and the pot.

### Sped-up play
Players may, at any time, fold their hand by throwing all cards face-down onto the table. That player is then eliminated from the remainder of the round. He/She is not excused, however, from paying double should the rules require it. There is no tactical advantage to folding.

Players with exceptionally strong hands may claim a win by displaying their remaining cards. If the hand is indeed unbeatable, they win the round, as if the hand had been played out normally. If their hand is not unbeatable, however, they are penalized. Again, there is no tactical advantage in claiming a win in this manner.

### Scoring
There is no scoring as such in Cat Te, only the accumulation of winnings. At the end of each round, the winner collects the pot, and any bonuses due to him from the other players.

### Automatic winning hands
In some games of Cat Te, the following hands are automatic wins—if a player is dealt one of these hands, he may display it immediately and the round ends. The player may win the pot, or double the pot, depending on the rules employed:

A hand containing four of a kind, of any rank, regardless of the two other cards. Note that a hand containing four aces is an automatic win, regardless of whether this optional rule is employed.
A hand containing a flush, consisting of six cards of the same suit. Note that a poker flush, five of the same suit is not sufficient.

It is a common strategy for a player whose hand is rich in a particular suit, and who believes, to keep playing the suit until it exhausted, in an attempt to win the fourth trick while playing low cards. Winning the fourth trick is advantageous. Conversely, if one suspects an opponent is doing this, to hold onto a high card in that suit until the fourth trick is played, in an attempt to win the pivotal fourth trick.

### Side pot
One other common variation is the maintenance of a side pot. In addition to the normal bet, at the start of each round, a set figure is bet into a side pot. At the completion of the deal, one additional card from the deck is upturned. If any player has the next card of the same suit, he is entitled to claim the side pot. He may do so at any time during the round, until the cards are collected and shuffled for the next round. If no player has the winning card, or a player who does forgets to claim the side pot, the pot accumulates until won.

The side pot is completely separate from the main game play; a player need not win the main round, or even win a single trick, to claim the side pot.

### Digital Implementation Notes
- Uses Flame engine for Flutter with component-based architecture
- Linear layout with 6 tableau piles (player hands) and 6 foundation piles (played cards)
- Real-time validation of suit-following rules and must-beat requirements
- Strategic folding system allowing any card to be folded at any time (except leader must play)
- Visual feedback system with multiple indicator types:
  - **Legal Card Highlighting**: Blue border on cards that can be legally played
  - **Current Player Highlighting**: Golden frame around active player's tableau pile
  - **Leader Indicator**: Crown icon above the trick leader's tableau pile
  - **Selection Highlighting**: Green border on currently selected card
- Enhanced drag-and-drop system:
  - Any face-up card can be dragged from any tableau pile
  - Cards only play when dropped on foundation piles
  - Illegal plays or drops elsewhere return card to origin
- Status overlay showing:
  - Current trick number (1-6)
  - Current turn player (PX)
  - Current trick leader (PX)
  - Region variant (Khmer/Laos/Vietnamese - tap to cycle)
  - Lead suit requirements and folding rules
  - Selected card information
- Action buttons for Play/Fold operations
- Debug logging for rule enforcement and strategic decisions
- Persistent played card display showing all face-up and face-down cards stacked on foundation piles
- Player turn management with automatic advancement after each play/fold
- Winner determination based on highest card of led suit (excluding folded cards)
- Instant win detection for special hands (four-of-a-kind, flush, low hand)
- Elimination system for Laos/Vietnamese variants after 4th trick
- Must-beat rule enforcement: players with lead suit cards must beat current best if possible
- Comprehensive rule validation preventing illegal suit violations

### User Interaction Methods
1. **Card Selection**: Tap any card in current player's hand to select/deselect
2. **Drag and Drop**: 
   - Drag any face-up card from any tableau pile
   - Drop on foundation pile to attempt play
   - Drop elsewhere returns card to origin
3. **Button Actions**:
   - **Play Button**: Plays currently selected card (if legal)
   - **Fold Button**: Folds currently selected card face-down
   - **Region Toggle**: Tap region name in status to cycle variants
4. **Visual Feedback**:
   - Blue highlighting shows legal plays for current player
   - Golden frame indicates current player's turn
   - Crown icon shows trick leader
   - Green border shows selected card

### Technical Architecture
- **CatTeTrickRules**: Core game logic and rule enforcement
- **CatTeTrickStatusOverlay**: Real-time game state display
- **CatTeHighlightFrame**: Current player visual indicator
- **CatTeLeaderIndicator**: Crown icon for trick leader
- **Card Component**: Enhanced drag/drop with smart play detection
- **Foundation/Tableau Piles**: Separate areas for hands vs played cards
- **Game State Management**: Turn advancement, trick resolution, winner detection

---
## End of Cat Te Instructions
- --- IGNORE ---

## Game: Eat Reds (Also known as Chinese Ten)
- **Objective**: The object of this game is to amass the highest score by capturing red cards from the layout. Cards are captured by pairing them with another card, such that the total pip value of the pair is ten. Cards that already have a pip value of ten are paired by matching.

### Setup
To play Chinese Ten, all you need is a standard 52-card deck of playing cards.

Divide 24 by the number of players in the game. This number is the number of cards to deal each player. That is, in a two player game, deal twelve cards to each. In a three-player game, deal eight cards to each. In a four-player game, deal six to each. Place the stub in the center of the table, face down, forming the stock. Turn four cards face up from the top of the stock, putting them at the corners of the stock.

### Game play
The player to the dealer’s left goes first. A player’s turn begins with them playing a card from their hand face up to the table. If the pip value of this card plus the pip value of a card already on the table add up to ten, the player captures both cards. For example, a 7 on the table can be captured by playing a 3. A player can capture face cards and 10s on the table by playing another card of the same rank.

When a player captures a card, they place both it and the card used to capture it in a face-down won-cards pile on the table in front of them. Some cultural regions (Khmer, Laos, Vietnamese, Chinese) place the captured card face up for other players to see and strategize. Players do not add cards to their hands; the cards they are dealt initially are the only cards they will have for the whole game.

After playing a card from their hand, the player turns a card up from the stock. If this card can capture a card on the table, the player makes the capture. Otherwise, the card is simply left on the table with the others. The turn then passes to the left.

Special rules apply to face cards, 10s, and 5s, to prevent them from becoming uncapturable. If the initial layout includes a three-of-a-kind of one of these ranks, the fourth card of that rank captures the other three. When the four cards of the initial layout are all face cards, 10s, or 5s, the dealer captures all four of these cards before the first player’s turn.

### Scoring
The game should end with the last player running out of cards on the same turn the deck runs out, with the last card in the deck capturing the last card in the layout. Each player then turns over their won-cards, if not already face up, pile and calculates its value, as follows:

All black cards: 0 points
Red aces: 20 points each
Red face cards, 10s, and 9s: 10 points each
All other red cards: Pip value
The player with the highest score wins the game.

## End of Eat Reds Instructions
- --- IGNORE ---

## Game: Eat Pairs (Also known as Siku in Khmer)
- **Objective**: Be the first player to get rid of all cards by forming pairs of matching ranks.

### Players
- 2 to 6 players

### Setup
- Each player is dealt 7 cards from a standard 52-card deck
- Dealer receives 8 cards (one extra)
- Remaining cards form a face-down stock pile in the center
- Players sit around a table in fixed positions

### Initial Pair Laying
Before active play begins, all players (including dealer) must lay down any pairs they have:
- **Pair**: Two cards of the same rank (e.g., two 8s, two Queens) - lay both down
- **Three of a Kind**: Lay down two cards, keep the third in hand
- **Four of a Kind**: Lay down all four cards (counts as two pairs)
- Laid pairs are placed face-up in the player's foundation pile

### Game Flow - Critical Rule
**ONLY the dealer plays ONE card from hand to start the game. After that, ALL cards come from stock draws.**

### Gameplay Sequence

#### Phase 1: Dealer's Opening Play
1. **Dealer plays ONE card**: Dealer selects any card from their hand and plays it face-up to the waste pile (center)
2. **Automatic matching**: Game checks all players in order for a matching rank
3. **If match found**: 
   - Matching player automatically pairs both cards to their foundation
   - Matching player becomes the "lead player"
   - Both cards are removed (dealer's played card + matching player's card)
   - Lead player proceeds to Phase 2
4. **If no match found**: 
   - Dealer's card remains on waste pile
   - Dealer becomes/remains lead player
   - Dealer proceeds to Phase 2

#### Phase 2: Stock Drawing Loop
This phase continues until someone wins:

1. **Lead player draws from stock**: Click/tap the stock pile to draw one card
2. **Card appears on waste pile**: Drawn card is placed face-up on center waste pile
3. **Automatic matching check**: Game checks all players in order for matching rank
4. **If match found**:
   - Matching player automatically pairs both cards to their foundation
   - Matching player becomes the new lead player
   - Return to step 1 (new lead player draws)
5. **If no match found**:
   - Drawn card remains on waste pile (may stack multiple unmatched cards)
   - Lead player remains the same
   - Return to step 1 (same lead player draws again)

### Victory Condition
- First player to empty their hand (zero cards remaining) wins immediately
- This can happen either by:
  - Matching the last card in hand with a drawn/played card
  - Playing the last card (dealer only, if it's their opening play)

### Key Rules Summary
1. **One Hand Play Only**: Dealer plays exactly ONE card from hand to start, then never again
2. **All From Stock**: After dealer's initial card, every subsequent card comes from stock draws
3. **Automatic Matching**: When a card is played/drawn, the game automatically checks for matches
4. **Lead Player Draws**: The player who just made a pair becomes lead and draws next
5. **No Match = Keep Drawing**: If no one can match, lead player keeps drawing from stock
6. **First to Empty Wins**: As soon as a player has zero cards, they win

### Digital Implementation Notes
- Uses Flame engine for Flutter with component-based architecture
- Animated card dealing with round-robin distribution (like Eat Reds)
- Layout:
  - **Tableau piles** (bottom row): Player hands showing remaining cards
  - **Foundation piles** (middle row): Paired cards for each player
  - **Waste pile** (center top): Active card(s) waiting to be matched
  - **Stock pile** (right): Draw pile for lead player
- Visual feedback system:
  - **Green border**: Selected card in hand
  - **Status overlay**: Shows dealer, lead player, and current instructions
  - **Play button**: Only enabled for dealer's first card or when matching
- Automatic pair laying after initial deal animation completes
- Automatic matching detection when cards are played/drawn
- Hand count tracking for all players
- Lead player management with turn-based drawing
- `_dealerHasPlayedFirstCard` flag prevents multiple hand plays
- `_awaitingMatch` flag set to false to allow continuous stock drawing when no matches exist

### Game State Tracking
- **Dealer Index**: Player 0, receives 8 cards, plays first
- **Lead Player Index**: Current player who can draw from stock (changes after each successful match)
- **Current Player Index**: Updates to lead player after matches
- **Hand Counts**: Tracks remaining cards for each player
- **Active Card**: Card currently on waste pile waiting to be matched
- **Stock Cards Remaining**: Count of cards left in stock pile

### Technical Architecture
- **EatPairsRules**: Core game logic and rule enforcement
- **EatPairsStatusOverlay**: Real-time game state display
- **EatPairsPlayButton**: Button for dealer's first card and matching (future enhancement)
- **Card Component**: Selection highlighting with green border for Eat Pairs
- **Foundation/Tableau/Stock/Waste Piles**: Separate areas for different card states
- **Animation System**: doMove() with speed, delays, and onComplete callbacks

## End of Eat Pairs Instructions
- --- IGNORE ---

## Game: Klondike Solitaire
- **Objective**: Move all cards to the foundation piles, sorted by suit from Ace to King.
# Add additional games below using the same format.
# klondike2